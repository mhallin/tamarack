language: clojure
lein: lein2
jdk:
  - openjdk7

addons:
  postgresql: "9.3"

before_script:
  - createdb -e -U postgres -E UTF-8 -O $USER tamarack
  - sudo apt-add-repository -y ppa:chris-lea/node.js
  - sudo apt-get update -q
  - sudo apt-get install phantomjs nodejs
  - sudo npm install -g karma
  - sudo npm install -g karma-phantomjs-launcher
  - sudo npm install -g karma-jasmine

script:
  - bash ./provision/roles/leiningen/files/lein cljsbuild once
  - bash ./provision/roles/leiningen/files/lein midje
  - /usr/lib/node_modules/karma/bin/karma start --single-run
