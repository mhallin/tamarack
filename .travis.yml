language: clojure
lein: lein2

addons:
  postgresql: "9.3"

before_script:
  - createdb -e -U postgres -E UTF-8 -O $USER tamarack
  - sudo apt-get install phantomjs npm
  - sudo npm install -g karma karma-phantomjs-launcher karma-jasmine

script:
  - lein cljsbuild once
  - lein midje
  - /usr/local/lib/node_modules/karma/bin/karma start --single-run
